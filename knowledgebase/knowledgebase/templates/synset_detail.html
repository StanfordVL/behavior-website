{% extends "base.html" %}
{% block title %}Synset {{ synset.name }} Details{% endblock %}
{% block content %}
  <h1 class="text-center">{{ synset.name }}</h1>
  <hr/>
  {% if synset.legal %} 
  <div class="text-center">{{ synset.definition }}</div>
  {% else %}
  <div class="text-center">{{ Illegal }}</div>
  {% endif %}

  <br>
  <h2>Properties</h2>
  <div class="container">
    <div class="row justify-content-md-center">
      <!-- TODO: Add parameters -->
      {% for property in synset.properties %}
      <div class="col-md-auto my-1 py-2 border">{{ property.name }}</div>
      {% else %}
      <p>None</p>
      {% endfor %}
    </div>
  </div>
  <h2>Uses</h2>
  <div class="row justify-content-md-center">
    <div class="col-md-auto my-1 border py-2">{% if synset.is_used_as_substance %} IS {% else %} NOT {% endif %} used as substance</div>
    <div class="col-md-auto my-1 border py-2">{% if synset.is_used_as_non_substance %} IS {% else %} NOT {% endif %} used as non-substance</div>
    <div class="col-md-auto my-1 border py-2">{% if synset.is_used_as_fillable %} IS {% else %} NOT {% endif %} used as fillable</div>
  </div>
  <div class="row justify-content-md-center">
    {% for predicate in synset.used_in_predicates %}
    <div class="col-md-3 my-1 border py-2">{{ predicate.name }}</div>
    {% endfor %}
  </div>
  <h2>Tasks</h2>
  <div class="container">
    <div class="row justify-content-md-center">
      {% for task in synset.tasks %}
      <div class="col-md-auto my-1"><a href="{{ url_for('task_detail', name=task.name) }}" class="btn btn-{{- task.state|tocolor -}}">{{ task.name }}</a></div>
      {% else %}
      <div>None</div>
      {% endfor %}
    </div>
  </div>
  <br>

  <h2>Directly Mapped Categories</h2>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Category Name</th>
        </tr>
      </thead>
      <tbody>
        {% for category in synset.categories %}
        <tr>
          <td><a href="{{ url_for('category_detail', name=category.name) }}">{{ category.name }}</a></td>
        </tr>
        {% else %}
        <tr>
          <td>No categories found</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <br>
  
  <h2>Directly Mapped Objects</h2>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Object Name</th>
          <th>State</th>
        </tr>
      </thead>
      <tbody>
        {% for object in synset.direct_matching_object %}
        <tr>
          <td><a href="{{ url_for('object_detail', name=object.name) }}">{{ object.name }}</a></td>
          <td><span class="badge badge-{{ object.state|tocolor }}">{{ object.state|title }}</span></td>
        </tr>
        {% else %}
        <tr>
          <td colspan="2">No objects found</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <br>

  <h2>All Descendant Objects (including Direct)</h2>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Object Name</th>
          <th>State</th>
        </tr>
      </thead>
      <tbody>
        {% for object in synset.matching_objects %}
        <tr>
          <td><a href="{{ url_for('object_detail', name=object.name) }}">{{ object.name }}</a></td>
          <td><span class="badge badge-{{ object.state|tocolor }}">{{ object.state|title }}</span></td>
        </tr>
        {% else %}
        <tr>
          <td colspan="2">No objects found</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <br>

  <h2>Transitions that produce or use this object</h2>
  <div class="mermaid">
    graph TD;
      {% for node in synset.transition_subgraph.nodes %}
        {{ node|slugify }}({{ node }});
      {% endfor %}
      {% for edge in synset.transition_subgraph.edges %}
        {{ edge.0|slugify }} --> {{ edge.1|slugify }};
      {% endfor %}
  </div>

  <h2>Related Synsets</h2>
  {% with G=synset.subgraph, center_node=synset %}
    {% include "synset_graph_module.html" %}
  {% endwith %}
  <br>
  
  <h2>Ancestor Synsets</h2>
  <div class="container">
    <div class="row justify-content-md-center">
      {% for ancestor in synset.ancestors%}
      <div class="col-md-auto my-1"><a href="{{ url_for('synset_detail', name=ancestor.name) }}" class="btn btn-{{- ancestor.state|tocolor -}}">{{ ancestor.name }}</a></div>
      {% else %}
      <p>None</p>
      {% endfor %}
    </div>
  </div>
  <br>

  <h2>Parents Synsets</h2>
  <div class="container">
    <div class="row justify-content-md-center">
      {% for parent in synset.parents%}
      <div class="col-md-auto my-1"><a href="{{ url_for('synset_detail', name=parent.name) }}" class="btn btn-{{- parent.state|tocolor -}}">{{ parent.name }}</a></div>
      {% else %}
      <p>None</p>
      {% endfor %}
    </div>
  </div>
  <br>

  <h2>Children Synsets</h2>
  <div class="container">
    <div class="row">
      {% for child in synset.children %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body">
            <a href="{{ url_for('synset_detail', name=child.name) }}" class="text-decoration-none">
              <h5 class="card-title">{{ child.name }}</h5>
              <p class="card-text">
                <span class="badge badge-{{ child.state|tocolor }}">{{ child.state|title }}</span>
              </p>
            </a>
          </div>
        </div>
      </div>
      {% else %}
      <div class="col-12">
        <div class="alert alert-info">No children synsets found</div>
      </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
